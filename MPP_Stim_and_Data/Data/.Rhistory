#It will pull data from the main MannerPath_Data.csv and from the trial data
#(Repo/MPP_Stim_and_Data/Data) from each child. There are (currently) two different
#experiments/conditions in the dataset:
#
# MannerPath - the original version (MP learning/bias), with no extension version
# ActionEffect+Extend - AE learning/bias, followed by MP trials which have only bias phase
# Just for super awesome fun times, subjects before #77 in AE-Extend have a variety of
# slightly different matlab outputs, and some of them only have AE data but no extension.
# Hence data cleaning/reformatting is...a bit messy.
library(dplyr)
#Clear any lingering variables
rm(list=ls())
#set directories; you might need to change this on your computer!
repodir = "/Users/mekline/Dropbox/_Projects/PrimingMannerPath/MannerPathPriming/"
adir = paste(repodir, "Analysis/", sep="")
ddir = paste(repodir, "MPP_Stim_and_Data/Data/" , sep="")
setwd(repodir)
#name of info file
nameMetaFile = paste(repodir,"MannerPath_Data.csv",sep="")
#get all .dat files in the directory
files = list.files(ddir, pattern = ".dat$")
#create an empty error list
error_files = list()
#load the info data file
participantData = read.csv(nameMetaFile, sep = ",", header = T)
#loop over files (participants) and the rows in the file
#Here melissa starts making some changes to read in both regular and extension data in a flexible way...
#The goal: For now, just read in all lines of every data file. Assert that all have the same columns
#names at the start, but some may have extra columns if they have extension data. Later on we'll
#clean up and reshape to get nicer formatted data.
#Notes:
# - No .dat files for 1,2, 35, 42, 69 (1-2 pilot, 35-69 kids who consented
# but didn't get to the exp)
#
# -
counter = 0
goodcounter = 0
badcounter = 0
setwd(ddir)
allData <- data.frame(NULL)
for (file in files) {
counter = counter + 1
#read in the file
trialData = try(read.table(file, sep = ",", header = T))
isError = FALSE
#test if there is data in that file, else place in the error vector
if (is.data.frame(trialData)) {
print(trialData$SubjectNo)
print(nrow(trialData))
if (nrow(trialData) > 2) {
goodcounter = goodcounter + 1
#get info for current participant
pData = try(participantData[participantData$Participant.. == trialData$SubjectNo[1],])
#Build out the rows for this participant
#Add these rows to the giant data frame
allData <- bind_rows(pData, allData)
} else {
isError = TRUE
}
} else {
isError = TRUE
}
if (isError) {
badcounter = badcounter+ 1
print('get here')
error_files[[length(error_files) + 1]] <- file
}
}
print(counter)
print(goodcounter)
print(badcounter)
# This file is going to have the full analysis pipeline for the MannerPath studies!
#It will pull data from the main MannerPath_Data.csv and from the trial data
#(Repo/MPP_Stim_and_Data/Data) from each child. There are (currently) two different
#experiments/conditions in the dataset:
#
# MannerPath - the original version (MP learning/bias), with no extension version
# ActionEffect+Extend - AE learning/bias, followed by MP trials which have only bias phase
# Just for super awesome fun times, subjects before #77 in AE-Extend have a variety of
# slightly different matlab outputs, and some of them only have AE data but no extension.
# Hence data cleaning/reformatting is...a bit messy.
library(dplyr)
#Clear any lingering variables
rm(list=ls())
#set directories; you might need to change this on your computer!
repodir = "/Users/mekline/Dropbox/_Projects/PrimingMannerPath/MannerPathPriming/"
adir = paste(repodir, "Analysis/", sep="")
ddir = paste(repodir, "MPP_Stim_and_Data/Data/" , sep="")
setwd(repodir)
#name of info file
nameMetaFile = paste(repodir,"MannerPath_Data.csv",sep="")
#get all .dat files in the directory
files = list.files(ddir, pattern = ".dat$")
#create an empty error list
error_files = list()
#load the info data file
participantData = read.csv(nameMetaFile, sep = ",", header = T)
#loop over files (participants) and the rows in the file
#Here melissa starts making some changes to read in both regular and extension data in a flexible way...
#The goal: For now, just read in all lines of every data file. Assert that all have the same columns
#names at the start, but some may have extra columns if they have extension data. Later on we'll
#clean up and reshape to get nicer formatted data.
#Notes:
# - No .dat files for 1,2, 35, 42, 69 (1-2 pilot, 35-69 kids who consented
# but didn't get to the exp)
#
# - 5/4/16: 26 files do not load at the pt, because fuss-outs & exp errors
#almost always broke the data file too. See MPP_data.csv for inclusion/exclusion
setwd(ddir)
allData <- data.frame(NULL)
for (file in files) {
isError = FALSE
#read in the file
trialData = try(read.table(file, sep = ",", header = T))
#test if there is data in that file, else place in the error vector
if (is.data.frame(trialData)) {
if (nrow(trialData) > 2) {
#get info for current participant
pData = try(participantData[participantData$Participant.. == trialData$SubjectNo[1],])
#Build out the rows for this participant
#Add these rows to the giant data frame
allData <- bind_rows(pData, allData)
} else {
isError = TRUE
}
} else {
isError = TRUE
}
if (isError) {
error_files[[length(error_files) + 1]] <- file
}
}
# This file is going to have the full analysis pipeline for the MannerPath studies!
#It will pull data from the main MannerPath_Data.csv and from the trial data
#(Repo/MPP_Stim_and_Data/Data) from each child. There are (currently) two different
#experiments/conditions in the dataset:
#
# MannerPath - the original version (MP learning/bias), with no extension version
# ActionEffect+Extend - AE learning/bias, followed by MP trials which have only bias phase
# Just for super awesome fun times, subjects before #77 in AE-Extend have a variety of
# slightly different matlab outputs, and some of them only have AE data but no extension.
# Hence data cleaning/reformatting is...a bit messy.
library(dplyr)
#Clear any lingering variables
rm(list=ls())
#set directories; you might need to change this on your computer!
repodir = "/Users/mekline/Dropbox/_Projects/PrimingMannerPath/MannerPathPriming/"
adir = paste(repodir, "Analysis/", sep="")
ddir = paste(repodir, "MPP_Stim_and_Data/Data/" , sep="")
setwd(repodir)
#name of info file
nameMetaFile = paste(repodir,"MannerPath_Data.csv",sep="")
#get all .dat files in the directory
files = list.files(ddir, pattern = ".dat$")
#create an empty error list
error_files = list()
#load the info data file
participantData = read.csv(nameMetaFile, sep = ",", header = T)
#loop over files (participants) and the rows in the file
#Here melissa starts making some changes to read in both regular and extension data in a flexible way...
#The goal: For now, just read in all lines of every data file. Assert that all have the same columns
#names at the start, but some may have extra columns if they have extension data. Later on we'll
#clean up and reshape to get nicer formatted data.
#Notes:
# - No .dat files for 1,2, 35, 42, 69 (1-2 pilot, 35-69 kids who consented
# but didn't get to the exp)
#
# - 5/4/16: 26 files do not load at the pt, because fuss-outs & exp errors
#almost always broke the data file too. See MPP_data.csv for inclusion/exclusion
setwd(ddir)
allData <- data.frame(NULL)
for (file in files) {
counter = counter + 1
#read in the file
trialData = try(read.table(file, sep = ",", header = T))
isError = FALSE
#test if there is data in that file, else place in the error vector
if (is.data.frame(trialData)) {
print(trialData$SubjectNo)
print(nrow(trialData))
if (nrow(trialData) > 2) {
goodcounter = goodcounter + 1
#get info for current participant
pData = try(participantData[participantData$Participant.. == trialData$SubjectNo[1],])
#Build out the rows for this participant
#Add these rows to the giant data frame
allData <- bind_rows(pData, allData)
} else {
isError = TRUE
}
} else {
isError = TRUE
}
if (isError) {
badcounter = badcounter+ 1
print('get here')
error_files[[length(error_files) + 1]] <- file
}
}
print(counter)
print(goodcounter)
print(badcounter)
# This file is going to have the full analysis pipeline for the MannerPath studies!
#It will pull data from the main MannerPath_Data.csv and from the trial data
#(Repo/MPP_Stim_and_Data/Data) from each child. There are (currently) two different
#experiments/conditions in the dataset:
#
# MannerPath - the original version (MP learning/bias), with no extension version
# ActionEffect+Extend - AE learning/bias, followed by MP trials which have only bias phase
# Just for super awesome fun times, subjects before #77 in AE-Extend have a variety of
# slightly different matlab outputs, and some of them only have AE data but no extension.
# Hence data cleaning/reformatting is...a bit messy.
library(dplyr)
#Clear any lingering variables
rm(list=ls())
#set directories; you might need to change this on your computer!
repodir = "/Users/mekline/Dropbox/_Projects/PrimingMannerPath/MannerPathPriming/"
adir = paste(repodir, "Analysis/", sep="")
ddir = paste(repodir, "MPP_Stim_and_Data/Data/" , sep="")
setwd(repodir)
#name of info file
nameMetaFile = paste(repodir,"MannerPath_Data.csv",sep="")
#get all .dat files in the directory
files = list.files(ddir, pattern = ".dat$")
#create an empty error list
error_files = list()
#load the info data file
participantData = read.csv(nameMetaFile, sep = ",", header = T)
#loop over files (participants) and the rows in the file
#Here melissa starts making some changes to read in both regular and extension data in a flexible way...
#The goal: For now, just read in all lines of every data file. Assert that all have the same columns
#names at the start, but some may have extra columns if they have extension data. Later on we'll
#clean up and reshape to get nicer formatted data.
#Notes:
# - No .dat files for 1,2, 35, 42, 69 (1-2 pilot, 35-69 kids who consented
# but didn't get to the exp)
#
# - 5/4/16: 26 files do not load at the pt, because fuss-outs & exp errors
#almost always broke the data file too. See MPP_data.csv for inclusion/exclusion
counter = 0
goodcounter = 0
badcounter = 0
setwd(ddir)
allData <- data.frame(NULL)
for (file in files) {
counter = counter + 1
#read in the file
trialData = try(read.table(file, sep = ",", header = T))
isError = FALSE
#test if there is data in that file, else place in the error vector
if (is.data.frame(trialData)) {
print(trialData$SubjectNo)
print(nrow(trialData))
if (nrow(trialData) > 2) {
goodcounter = goodcounter + 1
#get info for current participant
pData = try(participantData[participantData$Participant.. == trialData$SubjectNo[1],])
#Build out the rows for this participant
#Add these rows to the giant data frame
allData <- bind_rows(pData, allData)
} else {
isError = TRUE
}
} else {
isError = TRUE
}
if (isError) {
badcounter = badcounter+ 1
print('get here')
error_files[[length(error_files) + 1]] <- file
}
}
print(counter)
print(goodcounter)
print(badcounter)
error_files
# This file is going to have the full analysis pipeline for the MannerPath studies!
#It will pull data from the main MannerPath_Data.csv and from the trial data
#(Repo/MPP_Stim_and_Data/Data) from each child. There are (currently) two different
#experiments/conditions in the dataset:
#
# MannerPath - the original version (MP learning/bias), with no extension version
# ActionEffect+Extend - AE learning/bias, followed by MP trials which have only bias phase
# Just for super awesome fun times, subjects before #77 in AE-Extend have a variety of
# slightly different matlab outputs, and some of them only have AE data but no extension.
# Hence data cleaning/reformatting is...a bit messy.
library(dplyr)
#Clear any lingering variables
rm(list=ls())
#set directories; you might need to change this on your computer!
repodir = "/Users/mekline/Dropbox/_Projects/PrimingMannerPath/MannerPathPriming/"
adir = paste(repodir, "Analysis/", sep="")
ddir = paste(repodir, "MPP_Stim_and_Data/Data/" , sep="")
setwd(repodir)
#name of info file
nameMetaFile = paste(repodir,"MannerPath_Data.csv",sep="")
#get all .dat files in the directory
files = list.files(ddir, pattern = ".dat$")
#create an empty error list
error_files = list()
#load the info data file
participantData = read.csv(nameMetaFile, sep = ",", header = T)
#loop over files (participants) and the rows in the file
#Here melissa starts making some changes to read in both regular and extension data in a flexible way...
#The goal: For now, just read in all lines of every data file. Assert that all have the same columns
#names at the start, but some may have extra columns if they have extension data. Later on we'll
#clean up and reshape to get nicer formatted data.
#Notes:
# - No .dat files for 1,2, 35, 42, 69 (1-2 pilot, 35-69 kids who consented
# but didn't get to the exp)
#
# - 5/4/16: 26 files do not load at the pt, because fuss-outs & exp errors
#almost always broke the data file too. See MPP_data.csv for inclusion/exclusion
# - 5/4/16: SOMETHING IS UP WITH 71-77, MAY NEED TO RECODE FROM VIDEO
setwd(ddir)
allData <- data.frame(NULL)
for (file in files) {
isError = FALSE
#read in the file
trialData = try(read.table(file, sep = ",", header = T))
#test if there is data in that file, else place in the error vector
if (is.data.frame(trialData)) {
if (nrow(trialData) > 2) {
goodcounter = goodcounter + 1
#get info for current participant
pData = try(participantData[participantData$Participant.. == trialData$SubjectNo[1],])
#Build out the rows for this participant
#Add these rows to the giant data frame
allData <- bind_rows(pData, allData)
} else {
isError = TRUE
}
} else {
isError = TRUE
}
if (isError) {
error_files[[length(error_files) + 1]] <- file
}
}
# This file is going to have the full analysis pipeline for the MannerPath studies!
#It will pull data from the main MannerPath_Data.csv and from the trial data
#(Repo/MPP_Stim_and_Data/Data) from each child. There are (currently) two different
#experiments/conditions in the dataset:
#
# MannerPath - the original version (MP learning/bias), with no extension version
# ActionEffect+Extend - AE learning/bias, followed by MP trials which have only bias phase
# Just for super awesome fun times, subjects before #77 in AE-Extend have a variety of
# slightly different matlab outputs, and some of them only have AE data but no extension.
# Hence data cleaning/reformatting is...a bit messy.
library(dplyr)
#Clear any lingering variables
rm(list=ls())
#set directories; you might need to change this on your computer!
repodir = "/Users/mekline/Dropbox/_Projects/PrimingMannerPath/MannerPathPriming/"
adir = paste(repodir, "Analysis/", sep="")
ddir = paste(repodir, "MPP_Stim_and_Data/Data/" , sep="")
setwd(repodir)
#name of info file
nameMetaFile = paste(repodir,"MannerPath_Data.csv",sep="")
#get all .dat files in the directory
files = list.files(ddir, pattern = ".dat$")
#create an empty error list
error_files = list()
#load the info data file
participantData = read.csv(nameMetaFile, sep = ",", header = T)
#loop over files (participants) and the rows in the file
#Here melissa starts making some changes to read in both regular and extension data in a flexible way...
#The goal: For now, just read in all lines of every data file. Assert that all have the same columns
#names at the start, but some may have extra columns if they have extension data. Later on we'll
#clean up and reshape to get nicer formatted data.
#Notes:
# - No .dat files for 1,2, 35, 42, 69 (1-2 pilot, 35-69 kids who consented
# but didn't get to the exp)
#
# - 5/4/16: 26 files do not load at the pt, because fuss-outs & exp errors
#almost always broke the data file too. See MPP_data.csv for inclusion/exclusion
# - 5/4/16: SOMETHING IS UP WITH 71-77, MAY NEED TO RECODE FROM VIDEO
setwd(ddir)
allData <- data.frame(NULL)
for (file in files) {
isError = FALSE
#read in the file
trialData = try(read.table(file, sep = ",", header = T))
#test if there is data in that file, else place in the error vector
if (is.data.frame(trialData)) {
if (nrow(trialData) > 2) {
#get info for current participant
pData = try(participantData[participantData$Participant.. == trialData$SubjectNo[1],])
#Build out the rows for this participant
#Add these rows to the giant data frame
allData <- bind_rows(pData, allData)
} else {
isError = TRUE
}
} else {
isError = TRUE
}
if (isError) {
error_files[[length(error_files) + 1]] <- file
}
}
names(trialData)
names(pData)
# This file is going to have the full analysis pipeline for the MannerPath studies!
#It will pull data from the main MannerPath_Data.csv and from the trial data
#(Repo/MPP_Stim_and_Data/Data) from each child. There are (currently) two different
#experiments/conditions in the dataset:
#
# MannerPath - the original version (MP learning/bias), with no extension version
# ActionEffect+Extend - AE learning/bias, followed by MP trials which have only bias phase
# Just for super awesome fun times, subjects before #77 in AE-Extend have a variety of
# slightly different matlab outputs, and some of them only have AE data but no extension.
# Hence data cleaning/reformatting is...a bit messy.
library(dplyr)
#Clear any lingering variables
rm(list=ls())
#set directories; you might need to change this on your computer!
repodir = "/Users/mekline/Dropbox/_Projects/PrimingMannerPath/MannerPathPriming/"
adir = paste(repodir, "Analysis/", sep="")
ddir = paste(repodir, "MPP_Stim_and_Data/Data/" , sep="")
setwd(repodir)
#name of info file
nameMetaFile = paste(repodir,"MannerPath_Data.csv",sep="")
#get all .dat files in the directory
files = list.files(ddir, pattern = ".dat$")
#create an empty error list
error_files = list()
#load the info data file
participantData = read.csv(nameMetaFile, sep = ",", header = T)
#loop over files (participants) and the rows in the file
#Here melissa starts making some changes to read in both regular and extension data in a flexible way...
#The goal: For now, just read in all lines of every data file. Assert that all have the same columns
#names at the start, but some may have extra columns if they have extension data. Later on we'll
#clean up and reshape to get nicer formatted data.
#Notes:
# - No .dat files for 1,2, 35, 42, 69 (1-2 pilot, 35-69 kids who consented
# but didn't get to the exp)
#
# - Lots of errors are printed anytime we hit a badly formatted .dat file:
# as of 5/4/16 26 files do not load at the pt, because fuss-outs & exp errors
#almost always broke the data file too. See MPP_data.csv for inclusion/exclusion
# - 5/4/16: SOMETHING IS UP WITH 71-77, MAY NEED TO RECODE FROM VIDEO
setwd(ddir)
allData <- data.frame(NULL)
for (file in files) {
isError = FALSE
#read in the file
trialData = try(read.table(file, sep = ",", header = T))
#test if there is data in that file, else place in the error vector
if (is.data.frame(trialData)) {
if (nrow(trialData) > 2) {
#get info for current participant
pData = try(participantData[participantData$Participant.. == trialData$SubjectNo[1],])
pData$SubjectNo = pData$Participant..
#Build out the rows for this participant
myData = left_join(trialData, pData, by="SubjectNo")
print(length(names(myData)))
#Add these rows to the giant data frame
allData <- bind_rows(myData, allData)
} else {
isError = TRUE
}
} else {
isError = TRUE
}
if (isError) {
error_files[[length(error_files) + 1]] <- file
}
}
names(allData)
allData$Video.File
names(alldata)
names(allData)
ncol(allData)
select(allData, one_of(c("SubjectNo", "VerbDomain")))
ncol(allData)
allData$SubjectNo
names(allData)
colToSave = c("SubjectNo","VerbDomain","Condition.x","trialNo","itemID","verbName","verbMeaning","mannerSideBias","pathSideBias","kidResponseBias","mannerSideTest","pathSideTest","kidResponseTest","Experiment","Verb.Condition","Video.File","Video.Release","Gender","Days.Old","Age.Years","Age.Months","Inclusion.Decision","Exclude.Reason","Experiment.Group","Has.video.release.","Condition.y","Experiment.x","Experiment.y","Condition","extAnswer","extPathEffect","extVerbName","extMannerMeans","extMannerSide","extPathSide","extensionStart","extensionEnd"
)
allData = select(allData, one_of(colToSave))
allData
select(alldata, contains("Condition"))
select(allData, contains("Condition"))
View(select(allData, contains("Condition")))
select(allData, -c("Condition","Condition.x"))
select(allData, -"Condition")
select(allData, -(Condition, Condition.x))
select(allData, -c(Condition, Condition.x))
select(allData, contains("Condition", "SubjectNo"))
select(allData, contains("Condition"), "SubjectNo")
select(allData, contains("Condition"), SubjectNo)
View(select(allData, contains("Condition"), SubjectNo))
names(allData)
View(select(allData, contains("Condition"), contains("VerbDomain"), contains("Experiment"),SubjectNo))
View(allData)
#It's a great big data frame! Begin by dropping columns that we don't need for analysis
colToSave = c("SubjectNo","VerbDomain","Condition.x","trialNo","itemID",
"verbName","verbMeaning","mannerSideBias","pathSideBias",
"kidResponseBias","mannerSideTest","pathSideTest",
"kidResponseTest","Experiment","Verb.Condition",
"Video.File","Video.Release","Gender","Days.Old",
"Age.Years","Age.Months","Inclusion.Decision",
"Exclude.Reason","Experiment.Group","Has.video.release.",
"Condition.y","Experiment.x","Experiment.y","Condition",
"extAnswer","extPathEffect","extVerbName","extMannerMeans",
"extMannerSide","extPathSide")
allData = select(allData, one_of(colToSave))
#A tremendous amount of column renaming to bring everything
#into alignment.
error_files
View(allData)
